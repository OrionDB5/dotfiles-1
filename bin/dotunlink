#!/bin/sh
# written by Shotaro Fujimoto (https://github.com/ssh0)
# first edited: 2015-09-13

show_usage() {
  echo "dotunlink"
  echo "Unlink the symbolic link mangaed by dotfiles and copy the file from the repository."
  echo ""
  echo "Usage: dotunlink FILE [FILE2 FILE3 ...]"
  echo "Option:"
  echo "  -h: show this help and exit"
}

if [ "$f" = "-h" ]; then
  show_usage
  exit 1
fi

for f in $@; do
  if [ ! -L $f ]; then
    echo "'$f' is not symbolic link."
  else
    # Get the file's path
    filename="$(basename $f)"
    currentpath="$(cd $(dirname $f); pwd)"/"${filename}"

    # Get the absolute path
    abspath="$(readlink $f)"

    # Unlink the file
    unlink "$currentpath"

    # Copy the file
    cp "$abspath" "$currentpath"
  fi
done
